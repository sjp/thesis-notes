<!DOCTYPE html>
<head><title>ARMA Models</title></head>
<body>
<h1>Interactive ARMA Models</h1>
<div id="user-input" style="clear: both;">
  <input id="dataset" type="file" value="Load Dataset">
  <select id="req-format">
    <option>SVG</option>
    <option>JSON</option>
  </select>
  <input id="arma-p" type="number" min="0" max="5" step="1" value="0" />
  <input id="arma-q" type="number" min="0" max="5" step="1" value="0" />
</div>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="672px" height="672px" version="1.1">
  <g transform="translate(0, 672) scale(1, -1)">
    <g id="gridSVG" fill="none" stroke="rgb(0,0,0)" stroke-dasharray="none" stroke-width="1.33px" font-size="16px" font-family="Helvetica, Arial, FreeSans, Liberation Sans, Nimbus Sans L, sans-serif" opacity="1" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" stroke-opacity="1" fill-opacity="0" font-weight="normal" font-style="normal">
      <g id="acfvp.1">
        <g id="acfvp::acfwindowvp.1">
          <g id="acfxaxis">
            <g id="acfxaxis.major">
              <polyline fill="none" id="acfxaxis.major.1" points="77.95,369.6 508.03,369.6"/>
            </g>
            <g id="acfxaxis.ticks">
              <polyline fill="none" id="acfxaxis.ticks.1" points="77.95,369.6 77.95,360"/>
              <polyline fill="none" id="acfxaxis.ticks.2" points="185.47,369.6 185.47,360"/>
              <polyline fill="none" id="acfxaxis.ticks.3" points="292.99,369.6 292.99,360"/>
              <polyline fill="none" id="acfxaxis.ticks.4" points="400.51,369.6 400.51,360"/>
              <polyline fill="none" id="acfxaxis.ticks.5" points="508.03,369.6 508.03,360"/>
            </g>
            <g id="acfxaxis.labels">
              <g transform="translate(77.95, 340.8)" stroke-width="0.1px" id="acfxaxis.labels.1">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="middle" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">0</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(185.47, 340.8)" stroke-width="0.1px" id="acfxaxis.labels.2">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="middle" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">10</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(292.99, 340.8)" stroke-width="0.1px" id="acfxaxis.labels.3">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="middle" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">20</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(400.51, 340.8)" stroke-width="0.1px" id="acfxaxis.labels.4">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="middle" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">30</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(508.03, 340.8)" stroke-width="0.1px" id="acfxaxis.labels.5">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="middle" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">40</tspan>
                  </text>
                </g>
              </g>
            </g>
          </g>
          <g id="acfyaxis">
            <g id="acfyaxis.major">
              <polyline fill="none" id="acfyaxis.major.1" points="67.2,381 67.2,626.18"/>
            </g>
            <g id="acfyaxis.ticks">
              <polyline fill="none" id="acfyaxis.ticks.1" points="67.2,381 57.6,381"/>
              <polyline fill="none" id="acfyaxis.ticks.2" points="67.2,421.86 57.6,421.86"/>
              <polyline fill="none" id="acfyaxis.ticks.3" points="67.2,462.73 57.6,462.73"/>
              <polyline fill="none" id="acfyaxis.ticks.4" points="67.2,503.59 57.6,503.59"/>
              <polyline fill="none" id="acfyaxis.ticks.5" points="67.2,544.45 57.6,544.45"/>
              <polyline fill="none" id="acfyaxis.ticks.6" points="67.2,585.32 57.6,585.32"/>
              <polyline fill="none" id="acfyaxis.ticks.7" points="67.2,626.18 57.6,626.18"/>
            </g>
            <g id="acfyaxis.labels">
              <g transform="translate(48, 381)" stroke-width="0.1px" id="acfyaxis.labels.1">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="end" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">-0.2</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(48, 421.86)" stroke-width="0.1px" id="acfyaxis.labels.2">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="end" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">0</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(48, 462.73)" stroke-width="0.1px" id="acfyaxis.labels.3">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="end" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">0.2</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(48, 503.59)" stroke-width="0.1px" id="acfyaxis.labels.4">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="end" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">0.4</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(48, 544.45)" stroke-width="0.1px" id="acfyaxis.labels.5">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="end" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">0.6</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(48, 585.32)" stroke-width="0.1px" id="acfyaxis.labels.6">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="end" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">0.8</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(48, 626.18)" stroke-width="0.1px" id="acfyaxis.labels.7">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="end" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">1</tspan>
                  </text>
                </g>
              </g>
            </g>
          </g>
          <g id="acfbox">
            <rect id="acfbox.1" x="67.2" y="369.6" width="537.6" height="268.8"/>
          </g>
          <g id="acfzeroline">
            <polyline fill="none" id="acfzeroline.1" points="67.2,421.86 604.8,421.86"/>
          </g>
          <g id="acfclims">
            <polyline stroke="rgb(0,0,255)" stroke-dasharray="5.33px,5.33px" stroke-opacity="1" fill="none" id="acfclims.1" points="67.2,461.91 604.8,461.91"/>
            <polyline stroke="rgb(0,0,255)" stroke-dasharray="5.33px,5.33px" stroke-opacity="1" fill="none" id="acfclims.2" points="67.2,381.82 604.8,381.82"/>
          </g>
          <g id="acfheights">
            <polyline fill="none" id="acfheights.1" points="77.95,421.86 77.95,626.18"/>
            <polyline fill="none" id="acfheights.2" points="88.7,421.86 88.7,523.7"/>
            <polyline fill="none" id="acfheights.3" points="99.46,421.86 99.46,500.44"/>
            <polyline fill="none" id="acfheights.4" points="110.21,421.86 110.21,488.85"/>
            <polyline fill="none" id="acfheights.5" points="120.96,421.86 120.96,470.73"/>
            <polyline fill="none" id="acfheights.6" points="131.71,421.86 131.71,468.53"/>
            <polyline fill="none" id="acfheights.7" points="142.46,421.86 142.46,468.31"/>
            <polyline fill="none" id="acfheights.8" points="153.22,421.86 153.22,467.23"/>
            <polyline fill="none" id="acfheights.9" points="163.97,421.86 163.97,483.15"/>
            <polyline fill="none" id="acfheights.10" points="174.72,421.86 174.72,450.82"/>
            <polyline fill="none" id="acfheights.11" points="185.47,421.86 185.47,440.21"/>
            <polyline fill="none" id="acfheights.12" points="196.22,421.86 196.22,465.89"/>
            <polyline fill="none" id="acfheights.13" points="206.98,421.86 206.98,465.37"/>
            <polyline fill="none" id="acfheights.14" points="217.73,421.86 217.73,470.28"/>
            <polyline fill="none" id="acfheights.15" points="228.48,421.86 228.48,461.62"/>
            <polyline fill="none" id="acfheights.16" points="239.23,421.86 239.23,453.41"/>
            <polyline fill="none" id="acfheights.17" points="249.98,421.86 249.98,461.66"/>
            <polyline fill="none" id="acfheights.18" points="260.74,421.86 260.74,449.74"/>
            <polyline fill="none" id="acfheights.19" points="271.49,421.86 271.49,460.62"/>
            <polyline fill="none" id="acfheights.20" points="282.24,421.86 282.24,453.38"/>
            <polyline fill="none" id="acfheights.21" points="292.99,421.86 292.99,445.15"/>
            <polyline fill="none" id="acfheights.22" points="303.74,421.86 303.74,439.95"/>
            <polyline fill="none" id="acfheights.23" points="314.5,421.86 314.5,434.51"/>
            <polyline fill="none" id="acfheights.24" points="325.25,421.86 325.25,422.99"/>
            <polyline fill="none" id="acfheights.25" points="336,421.86 336,422.57"/>
            <polyline fill="none" id="acfheights.26" points="346.75,421.86 346.75,432.22"/>
            <polyline fill="none" id="acfheights.27" points="357.5,421.86 357.5,429.17"/>
            <polyline fill="none" id="acfheights.28" points="368.26,421.86 368.26,416.86"/>
            <polyline fill="none" id="acfheights.29" points="379.01,421.86 379.01,406.02"/>
            <polyline fill="none" id="acfheights.30" points="389.76,421.86 389.76,419.77"/>
            <polyline fill="none" id="acfheights.31" points="400.51,421.86 400.51,419.17"/>
            <polyline fill="none" id="acfheights.32" points="411.26,421.86 411.26,398.26"/>
            <polyline fill="none" id="acfheights.33" points="422.02,421.86 422.02,402.06"/>
            <polyline fill="none" id="acfheights.34" points="432.77,421.86 432.77,386.16"/>
            <polyline fill="none" id="acfheights.35" points="443.52,421.86 443.52,387.59"/>
            <polyline fill="none" id="acfheights.36" points="454.27,421.86 454.27,392.32"/>
            <polyline fill="none" id="acfheights.37" points="465.02,421.86 465.02,404.17"/>
            <polyline fill="none" id="acfheights.38" points="475.78,421.86 475.78,419.44"/>
            <polyline fill="none" id="acfheights.39" points="486.53,421.86 486.53,430.85"/>
            <polyline fill="none" id="acfheights.40" points="497.28,421.86 497.28,408.78"/>
            <polyline fill="none" id="acfheights.41" points="508.03,421.86 508.03,406.82"/>
            <polyline fill="none" id="acfheights.42" points="518.78,421.86 518.78,394.74"/>
            <polyline fill="none" id="acfheights.43" points="529.54,421.86 529.54,414.49"/>
            <polyline fill="none" id="acfheights.44" points="540.29,421.86 540.29,401.2"/>
            <polyline fill="none" id="acfheights.45" points="551.04,421.86 551.04,406.21"/>
            <polyline fill="none" id="acfheights.46" points="561.79,421.86 561.79,408.19"/>
            <polyline fill="none" id="acfheights.47" points="572.54,421.86 572.54,391.81"/>
            <polyline fill="none" id="acfheights.48" points="583.3,421.86 583.3,390.53"/>
            <polyline fill="none" id="acfheights.49" points="594.05,421.86 594.05,397.95"/>
          </g>
        </g>
      </g>
      <g id="pacfvp.1">
        <g id="pacfvp::pacfwindowvp.1">
          <g id="pacfxaxis">
            <g id="pacfxaxis.major">
              <polyline fill="none" id="pacfxaxis.major.1" points="67.2,33.6 506.06,33.6"/>
            </g>
            <g id="pacfxaxis.ticks">
              <polyline fill="none" id="pacfxaxis.ticks.1" points="67.2,33.6 67.2,24"/>
              <polyline fill="none" id="pacfxaxis.ticks.2" points="176.91,33.6 176.91,24"/>
              <polyline fill="none" id="pacfxaxis.ticks.3" points="286.63,33.6 286.63,24"/>
              <polyline fill="none" id="pacfxaxis.ticks.4" points="396.34,33.6 396.34,24"/>
              <polyline fill="none" id="pacfxaxis.ticks.5" points="506.06,33.6 506.06,24"/>
            </g>
            <g id="pacfxaxis.labels">
              <g transform="translate(67.2, 4.8)" stroke-width="0.1px" id="pacfxaxis.labels.1">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="middle" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">0</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(176.91, 4.8)" stroke-width="0.1px" id="pacfxaxis.labels.2">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="middle" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">10</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(286.63, 4.8)" stroke-width="0.1px" id="pacfxaxis.labels.3">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="middle" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">20</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(396.34, 4.8)" stroke-width="0.1px" id="pacfxaxis.labels.4">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="middle" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">30</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(506.06, 4.8)" stroke-width="0.1px" id="pacfxaxis.labels.5">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="middle" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">40</tspan>
                  </text>
                </g>
              </g>
            </g>
          </g>
          <g id="pacfyaxis">
            <g id="pacfyaxis.major">
              <polyline fill="none" id="pacfyaxis.major.1" points="67.2,44.41 67.2,290.74"/>
            </g>
            <g id="pacfyaxis.ticks">
              <polyline fill="none" id="pacfyaxis.ticks.1" points="67.2,44.41 57.6,44.41"/>
              <polyline fill="none" id="pacfyaxis.ticks.2" points="67.2,79.6 57.6,79.6"/>
              <polyline fill="none" id="pacfyaxis.ticks.3" points="67.2,114.79 57.6,114.79"/>
              <polyline fill="none" id="pacfyaxis.ticks.4" points="67.2,149.98 57.6,149.98"/>
              <polyline fill="none" id="pacfyaxis.ticks.5" points="67.2,185.17 57.6,185.17"/>
              <polyline fill="none" id="pacfyaxis.ticks.6" points="67.2,220.36 57.6,220.36"/>
              <polyline fill="none" id="pacfyaxis.ticks.7" points="67.2,255.55 57.6,255.55"/>
              <polyline fill="none" id="pacfyaxis.ticks.8" points="67.2,290.74 57.6,290.74"/>
            </g>
            <g id="pacfyaxis.labels">
              <g transform="translate(48, 44.41)" stroke-width="0.1px" id="pacfyaxis.labels.1">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="end" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">-0.2</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(48, 79.6)" stroke-width="0.1px" id="pacfyaxis.labels.2">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="end" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">-0.1</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(48, 114.79)" stroke-width="0.1px" id="pacfyaxis.labels.3">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="end" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">0</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(48, 149.98)" stroke-width="0.1px" id="pacfyaxis.labels.4">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="end" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">0.1</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(48, 185.17)" stroke-width="0.1px" id="pacfyaxis.labels.5">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="end" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">0.2</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(48, 220.36)" stroke-width="0.1px" id="pacfyaxis.labels.6">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="end" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">0.3</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(48, 255.55)" stroke-width="0.1px" id="pacfyaxis.labels.7">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="end" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">0.4</tspan>
                  </text>
                </g>
              </g>
              <g transform="translate(48, 290.74)" stroke-width="0.1px" id="pacfyaxis.labels.8">
                <g transform="scale(1, -1)">
                  <text x="0" y="0" text-anchor="end" fill="rgb(0,0,0)" fill-opacity="1">
                    <tspan dy="5.74" x="0">0.5</tspan>
                  </text>
                </g>
              </g>
            </g>
          </g>
          <g id="pacfbox">
            <rect id="pacfbox.1" x="67.2" y="33.6" width="537.6" height="268.8"/>
          </g>
          <g id="pacfzeroline">
            <polyline fill="none" id="pacfzeroline.1" points="67.2,114.79 604.8,114.79"/>
          </g>
          <g id="pacfclims">
            <polyline stroke="rgb(0,0,255)" stroke-dasharray="5.33px,5.33px" stroke-opacity="1" fill="none" id="pacfclims.1" points="67.2,183.76 604.8,183.76"/>
            <polyline stroke="rgb(0,0,255)" stroke-dasharray="5.33px,5.33px" stroke-opacity="1" fill="none" id="pacfclims.2" points="67.2,45.82 604.8,45.82"/>
          </g>
          <g id="pacfheights">
            <polyline fill="none" id="pacfheights.1" points="78.17,114.79 78.17,290.18"/>
            <polyline fill="none" id="pacfheights.2" points="89.14,114.79 89.14,178.54"/>
            <polyline fill="none" id="pacfheights.3" points="100.11,114.79 100.11,153.82"/>
            <polyline fill="none" id="pacfheights.4" points="111.09,114.79 111.09,116.96"/>
            <polyline fill="none" id="pacfheights.5" points="122.06,114.79 122.06,137.67"/>
            <polyline fill="none" id="pacfheights.6" points="133.03,114.79 133.03,139.65"/>
            <polyline fill="none" id="pacfheights.7" points="144,114.79 144,136.02"/>
            <polyline fill="none" id="pacfheights.8" points="154.97,114.79 154.97,172.11"/>
            <polyline fill="none" id="pacfheights.9" points="165.94,114.79 165.94,62.71"/>
            <polyline fill="none" id="pacfheights.10" points="176.91,114.79 176.91,92.06"/>
            <polyline fill="none" id="pacfheights.11" points="187.89,114.79 187.89,181.81"/>
            <polyline fill="none" id="pacfheights.12" points="198.86,114.79 198.86,145.46"/>
            <polyline fill="none" id="pacfheights.13" points="209.83,114.79 209.83,137.62"/>
            <polyline fill="none" id="pacfheights.14" points="220.8,114.79 220.8,96.28"/>
            <polyline fill="none" id="pacfheights.15" points="231.77,114.79 231.77,104.3"/>
            <polyline fill="none" id="pacfheights.16" points="242.74,114.79 242.74,140.44"/>
            <polyline fill="none" id="pacfheights.17" points="253.71,114.79 253.71,120.8"/>
            <polyline fill="none" id="pacfheights.18" points="264.69,114.79 264.69,155.27"/>
            <polyline fill="none" id="pacfheights.19" points="275.66,114.79 275.66,71.26"/>
            <polyline fill="none" id="pacfheights.20" points="286.63,114.79 286.63,93.93"/>
            <polyline fill="none" id="pacfheights.21" points="297.6,114.79 297.6,113.95"/>
            <polyline fill="none" id="pacfheights.22" points="308.57,114.79 308.57,120.57"/>
            <polyline fill="none" id="pacfheights.23" points="319.54,114.79 319.54,92.08"/>
            <polyline fill="none" id="pacfheights.24" points="330.51,114.79 330.51,76.14"/>
            <polyline fill="none" id="pacfheights.25" points="341.49,114.79 341.49,137.57"/>
            <polyline fill="none" id="pacfheights.26" points="352.46,114.79 352.46,106.91"/>
            <polyline fill="none" id="pacfheights.27" points="363.43,114.79 363.43,89.48"/>
            <polyline fill="none" id="pacfheights.28" points="374.4,114.79 374.4,85.88"/>
            <polyline fill="none" id="pacfheights.29" points="385.37,114.79 385.37,124.09"/>
            <polyline fill="none" id="pacfheights.30" points="396.34,114.79 396.34,119.66"/>
            <polyline fill="none" id="pacfheights.31" points="407.31,114.79 407.31,57.8"/>
            <polyline fill="none" id="pacfheights.32" points="418.29,114.79 418.29,107.15"/>
            <polyline fill="none" id="pacfheights.33" points="429.26,114.79 429.26,47.73"/>
            <polyline fill="none" id="pacfheights.34" points="440.23,114.79 440.23,108.38"/>
            <polyline fill="none" id="pacfheights.35" points="451.2,114.79 451.2,151.56"/>
            <polyline fill="none" id="pacfheights.36" points="462.17,114.79 462.17,144.27"/>
            <polyline fill="none" id="pacfheights.37" points="473.14,114.79 473.14,128.34"/>
            <polyline fill="none" id="pacfheights.38" points="484.11,114.79 484.11,131.21"/>
            <polyline fill="none" id="pacfheights.39" points="495.09,114.79 495.09,112.11"/>
            <polyline fill="none" id="pacfheights.40" points="506.06,114.79 506.06,110.97"/>
            <polyline fill="none" id="pacfheights.41" points="517.03,114.79 517.03,87.5"/>
            <polyline fill="none" id="pacfheights.42" points="528,114.79 528,180.06"/>
            <polyline fill="none" id="pacfheights.43" points="538.97,114.79 538.97,53.71"/>
            <polyline fill="none" id="pacfheights.44" points="549.94,114.79 549.94,136.47"/>
            <polyline fill="none" id="pacfheights.45" points="560.91,114.79 560.91,126.06"/>
            <polyline fill="none" id="pacfheights.46" points="571.89,114.79 571.89,85.63"/>
            <polyline fill="none" id="pacfheights.47" points="582.86,114.79 582.86,128.28"/>
            <polyline fill="none" id="pacfheights.48" points="593.83,114.79 593.83,116.91"/>
          </g>
        </g>
      </g>
    </g>
  </g>
</svg>
<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script type="text/javascript" src="http://underscorejs.org/underscore-min.js"></script>
<script type="text/javascript" src="http://backbonejs.org/backbone-min.js"></script>
<script type="text/javascript" src="http://d3js.org/d3.v2.min.js"></script>
<script type="text/javascript" src="/custom/arma/coords.js"></script>
<script type="text/javascript">
    var TsModel = Backbone.Model.extend({
        defaults: {
            p: 0,
            q: 0,
            format: "SVG",
            file: null
        }
    });

    var ts = new TsModel();

    var TsView = Backbone.View.extend({
        el: $("#user-input"),

        events: {
            "change #dataset": "changeDataset",
            "change #arma-p": "updateParams",
            "change #arma-q": "updateParams",
        },
    
        updateParams: function() {
            this.model.set({p: $("#arma-p").val(),
                            q: $("#arma-q").val(),
                            format: $("#req-format").val()});
    
            var dt;
            if (this.model.get("format") === "JSON") {
                dt = "json";
            } else {
                dt = "xml";
            }
    
            $.ajax({
                url: "/custom/arma/brew/acf?" + $.param({
                    p: this.model.get("p"),
                    q: this.model.get("q"),
                    format: this.model.get("format")
                }),
                context: this,
                dataType: dt,
                success: this.drawParams
            });
        },
    
        drawParams: function(resp) {
            if (this.model.get("format") === "JSON") {
                this.drawParamsJSON(resp);
            } else {
                this.drawParamsSVG(resp);
            }
        },
    
        drawParamsJSON: function(obj) {
            var acf = obj.acf;
            var pacf = obj.pacf;
            d3.selectAll("#acfheights polyline")
                .data(acf)
                .transition()
                .duration(1000)
                .attr("points", function(d) {
                  return d;
                });
            d3.selectAll("#pacfheights polyline")
                .data(pacf)
                .transition()
                .duration(1000)
                .attr("points", function(d) {
                  return d;
                });
        },
    
        drawParamsSVG: function(svgdoc) {
            var acf = $(svgdoc).find("g").get(0);
            var pacf = $(svgdoc).find("g").get(1);
            d3.selectAll("#acfheights polyline")
                .transition()
                .duration(1000)
                .attr("points", function(d, i) {
                  return $(acf).find("polyline")
                               .get(i).getAttribute("points");
                });
            d3.selectAll("#pacfheights polyline")
                .transition()
                .duration(1000)
                .attr("points", function(d, i) {
                  return $(pacf).find("polyline")
                                .get(i).getAttribute("points");
                });
        },
    
        changeDataset: function() {
            this.model.set({file: $("#dataset").prop("files")[0]});
            var fd = new FormData();
            fd.append("dataset", this.model.get("file"));
            $.ajax({
                url: "/custom/arma/brew/loadDataset?p=0&q=0&format=SVG",
                type: "POST",
                data: fd,
                contentType: false,
                processData: false,
                context: this,
                success: this.drawUpdatedDataset
            });
        },
    
        drawUpdatedDataset: function(svgdoc) {
            // Setting acf y-axis
            var oldacfyaxis = $("#acfyaxis").get(0);
            var newacfyaxis = $(svgdoc).find("#acfyaxis").get(0);
            d3.select(newacfyaxis).attr("opacity", 0); // Make it invisible first
            $(newacfyaxis).insertBefore(oldacfyaxis);
    
            // Fade out
            d3.select(oldacfyaxis)
                .transition()
                .duration(1000)
                .attr("opacity", 0)
                .remove();
            // Fade in
            d3.select(newacfyaxis)
                .transition()
                .duration(1000)
                .attr("opacity", 1);
    
            var oldpacfyaxis = $("#pacfyaxis").get(0);
            var newpacfyaxis = $(svgdoc).find("#pacfyaxis").get(0);
            d3.select(newpacfyaxis).attr("opacity", 0); // Make it invisible first
            $(newpacfyaxis).insertBefore(oldpacfyaxis);
    
            // Fade out
            d3.select(oldpacfyaxis)
                .transition()
                .duration(1000)
                .attr("opacity", 0)
                .remove();
            // Fade in
            d3.select(newpacfyaxis)
                .transition()
                .duration(1000)
                .attr("opacity", 1);
    
            // Note that the following values can just be transitioned towards.
            // This is because we are not *replacing*, merely *transforming*.
            // This gives us a nice smooth transition rather than a fade in/out.
    
            // Setting the horizontal lines at y = 0 for both plots
            var acfzerovalue = $(svgdoc).find("#acfzeroline polyline").attr("points");
            var pacfzerovalue = $(svgdoc).find("#pacfzeroline polyline").attr("points");
            d3.select("#acfzeroline polyline")
                .transition()
                .duration(1000)
                .attr("points", acfzerovalue);
            d3.select("#pacfzeroline polyline")
                .transition()
                .duration(1000)
                .attr("points", pacfzerovalue);
    
            // Setting the confidence intervals
            var acfclim1value = $(svgdoc).find("#acfclims\\.1").attr("points");
            var acfclim2value = $(svgdoc).find("#acfclims\\.2").attr("points");
            var pacfclim1value = $(svgdoc).find("#pacfclims\\.1").attr("points");
            var pacfclim2value = $(svgdoc).find("#pacfclims\\.2").attr("points");
    
            // Annoyingly '.'s need to be escaped
            d3.select("#acfclims\\.1")
                .transition()
                .duration(1000)
                .attr("points", acfclim1value);
            d3.select("#acfclims\\.2")
                .transition()
                .duration(1000)
                .attr("points", acfclim2value);
            d3.select("#pacfclims\\.1")
                .transition()
                .duration(1000)
                .attr("points", pacfclim1value);
            d3.select("#pacfclims\\.2")
                .transition()
                .duration(1000)
                .attr("points", pacfclim2value);
    
            // Finally setting the line heights
            var acflinegroup = $(svgdoc).find("#acfheights").get(0);
            var pacflinegroup = $(svgdoc).find("#pacfheights").get(0);
            d3.selectAll("#acfheights polyline")
                .transition()
                .duration(1000)
                .attr("points", function(d, i) {
                    return $(acflinegroup).find("polyline")
                                          .get(i).getAttribute("points");
                });
            d3.selectAll("#pacfheights polyline")
                .transition()
                .duration(1000)
                .attr("points", function(d, i) {
                    return $(pacflinegroup).find("polyline")
                                           .get(i).getAttribute("points");
                });
    
            // Do last
            $("#arma-p").val(0);
            $("#arma-q").val(0);
        }
    });

    var tsv = new TsView({model: ts});

    $(document).ready(function() {
        var fd = new FormData();
        fd.append("coords", JSON.stringify(gridSVGCoords));
        $.ajax({
            url: "/custom/arma/brew/initCoords",
            type: "POST",
            contentType: false,
            processData: false,
            data: fd,
            success: function() {
              console.log("coords info successfully sent");
            }
        });
    });
</script>
</body>
</html>
